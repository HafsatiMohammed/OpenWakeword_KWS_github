# Custom Wakeword Model Construction

This repository deals with the construction of a custom wakeword model based on the OpenWakeword approach. For this approach, there is no need for data collection. The true samples are generated through Google Text-to-Speech API and augmented with the Coqui AI cloning module. This approach requires downloading a substantial number of negative samples, which is handled in this repository by proposing several ways to do so: YouTube video downloads, huge video data downloads, and Common Voice datasets in different languages. Please be aware of paths, as some scripts may require path customization.

## Repository Structure

The repository is divided into two main folders:

1. **Data_Generation**: This folder handles data generation.

2. **Training**: This folder covers feature extraction and training.

## Data Generation

### Negative Samples

To generate negative samples, follow these steps:

#### 1. Download Videos from YouTube

Launch the following bash script to download pre-sampled 16,000 Hz audio from YouTube videos:

```bash
bash Download_Videos_bis.sh
```
This script takes advantage of the server structure to simultaneously download multiple videos.

#### 2. Obtain an MP3 Database
Download an MP3 database containing various audio files obtained from YouTube. Execute the script:
```bash
bash Download_Videos_bis.sh
```
After downloading, extract the tar file. The files are organized into subfolders; you'll need to create a routine to move all files into a single folder called "mp3."

#### 3. Resample MP3 Files
Resample the MP3 files to 16,000 Hz by running the following bash script:
```bash
bash Resamples_ffmpeg_ESC.sh
```
This script efficiently resamples multiple files simultaneously.

#### 4. Download and Resample the Common Voice Dataset
Execute the following script to download the Common Voice dataset, excluding sentences that contain the wakeword:
```bash
bash Download_Common_Voice_All_languages.sh
```
To customize the wakeword, manually edit line 50 in Download_Common_Voice.py. Afterward, resample the audio files to 16,000 Hz using the following command:

```bash
bash Resample_ffmpeg.sh
```
Finally, merge all the folders together to consolidate your negative samples.

### Positive Samples
Generate positive samples as follows:

#### 1. Generate Wakeword Folders
Use the Python script tts_api.py to create folders for the wakeword:
```bash
bash python tts_api.py

```


To customize the wakeword, manually edit the words in the script.


#### 2. Clone Voices
Clone voices by considering other voices from a dataset with different voices (e.g., LibriSpeech). Adjust the path to this dataset in Clone_Voices.py, and then run:

```bash
python Clone_Voices.py

```

#### 3. Resample Cloned Voices
Resample the cloned voices by running the following Python script:


```bash
python ResampleFiles_Cloned.py
```


#### 3.  Merge Generated Files
Combine the files generated by the Google API and those created by voice cloning, ensuring that all are resampled to 16,000 Hz.




## Training

To train your custom wakeword model, follow these steps:


### Feature Extraction

Run the feature extraction script twice:

#### 1. For negative samples:

```bash
python FeatureExtraction.py -Neg 1 -D '0'
```

#### 2. For positive samples (repeat for each wakeword):


```bash
python FeatureExtraction.py -Neg 0 -W 'your_wakeword' -D '0'

```

Ensure you have a noise dataset; you can use the audio resampled during data generation.

### Model Training

Finally, train a model per wakeword by executing the following command:



```bash
python TrainingOW_ModelPerWord.py -W 'your_wakeword'

```
Make necessary adjustments to the script if your wakeword is not "tuito aide" or "secours." Essentially, provide the paths to the generated .npy files for negative and positive examples.


